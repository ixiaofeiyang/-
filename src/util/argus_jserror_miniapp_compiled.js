var argusJserrorConstructor=function(){var d=!1;var a=null,g=argusJserrorConstructor.JSERROR_CACHE_SIZE,e=[],f=null;return{get_clipboard_cmd:function(){d=!1;a=null;wx.getClipboardData({success:function(c){var b=c.data.split("::");if(2===b.length&&"[wetest_miniapp_test]"===b[0]&&b[1])try{a=JSON.parse(b[1]),"undefined"!=typeof a.testid&&"undefined"!=typeof a.deviceid&&("undefined"!=typeof a.sessionid&&(d=!0),"undefined"!=typeof a.token&&"undefined"!=typeof a.time&&(d=!0))}catch(h){d=!1,wx.showModal({title:"\u4ece\u526a\u8d34\u677f\u4e2d\u89e3\u6790json\u5931\u8d25:",
content:c.data,showCancel:!1})}0==d&&wx.showModal({title:"\u65e0\u6cd5\u4ece\u526a\u8d34\u677f\u4e2d\u83b7\u5f97\u6b63\u786e\u4fe1\u606f:",content:c.data,showCancel:!1})},fail:function(a){wx.showModal({title:"\u65e0\u6cd5\u4ece\u526a\u8d34\u677f\u4e2d\u83b7\u5f97\u6b63\u786e\u4fe1\u606f:",content:"\u65e0\u6cd5\u4ece\u526a\u8d34\u677f\u4e2d\u83b7\u5f97\u6b63\u786e\u4fe1\u606f",showCancel:!1})}})},send_jserror_data_to_wetest:function(c){if(!1!==d&&null!==a&&0!==e.length){c={testid:a.testid,deviceid:a.deviceid,
data:JSON.stringify(e)};var b={};"undefined"!=typeof a.sessionid&&(b.Cookie=a.sessionid);"undefined"!=typeof a.token&&"undefined"!=typeof a.time&&(c.token=a.token,c.time=a.time);wx.request({url:argusJserrorConstructor.WETEST_MINIPRGJSERROR_API_URL,data:c,method:"POST",header:b,success:function(a){1==a.data.flag?e=[]:wx.showToast({title:"wetest jserror api fail, msg:"+a.data.msg,icon:"none"})},fail:function(a){wx.showToast({title:"wetest jserror api request fail:",icon:"none"})}})}},send_jserror:function(a,
b){a={timestamp:a,jserror:b};e.length>=g&&e.shift();e.push(a)},check_send_jserror:function(){f.send_jserror_data_to_wetest()},start:function(){f=this;f.get_clipboard_cmd();wx.onError(function(a){f.send_jserror(Date.now(),a)});setInterval(f.check_send_jserror,5E3)}}};argusJserrorConstructor.WETEST_MINIPRGJSERROR_API_URL="https://wetest.qq.com/cloud/api/miniappError";argusJserrorConstructor.JSERROR_CACHE_SIZE=100;var argusJserror=argusJserrorConstructor();argusJserror.start();module.exports={argusJserror:argusJserrorConstructor};
